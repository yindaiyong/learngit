<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ include file="/WEB-INF/views/include/global.jsp"%>
<script type="text/javascript">
$(function(){
	var list = '${list}';
	var processStep = '${processStep}';
	var confirmProcessStep = '${confirmProcessStep}';
	var sendProcessStep = '${sendProcessStep}';
	$.each(JSON.parse(list),function(index,value){
		var psiProcessStep = value.psiProcessStep;
		var psiFlowCode = value.psiFlowCode;
		if(psiFlowCode == "111111" && processStep != ""){
			if(processStep == '-1'){
				$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#009900');
			}else{
				if(processStep > psiProcessStep){
					$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#009900');
				}else if (processStep == psiProcessStep){
					$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#CB0909');
				}
			}
		}
		if(psiFlowCode == "222222" && confirmProcessStep != ""){
			if(confirmProcessStep == '-1'){
				$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#009900');
			}else{
				if(confirmProcessStep > psiProcessStep){
					$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#009900');
				}else if (confirmProcessStep == psiProcessStep){
					$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#CB0909');
				}
			}
		}
		if(psiFlowCode == "333333"){
			if(sendProcessStep == '-1'){
				$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#009900');
			}else{
				if(sendProcessStep > psiProcessStep){
					$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#009900');
				}else if(sendProcessStep == psiProcessStep){
					$("#"+psiProcessStep+psiFlowCode+"").css('background-color','#CB0909');
				}
			}
		}
	});
});

</script>
<style type = "text/css">
	.myself-easyuibtn {
		height: 70px !important;
		width:  70px !important;
	}
</style>
	<div style="width:90%;margin-left: 50px;margin-top: 30px" >
		<c:forEach items="${entity}" var = "item" varStatus="status" >
			<div class = "easyui-linkbutton myself-easyuibtn" style="border-radius:50%; background-color:#D8D8D8; margin-top: 15px;" onselectstart="return false" data-options="plain:true" id ="${item.psiProcessStep}${item.psiFlowCode}">
				<%--<span style = "font-size :18px;font-weight: 900;letter-spacing:2px;font-family:Serif;">
						${item.psiProcessName }
				</span>--%>
				<div style = "width: 45px;height:45px;font-size :18px;font-weight: 900;letter-spacing:2px;font-family:Serif; margin: 12px 1px;">
						${item.psiProcessName }
				</div>
			</div>
			<c:if test="${!status.last}">
			<c:choose>
				<c:when test="${ item.psiProcessStep eq '-1' }">
					<img src="${ctx}/static/images/green.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center" >
				</c:when>
				<%--全部成功--%>
				<c:when test="${confirmProcessStep eq '-1' && item.psiFlowCode eq '222222'}">
					<img src="${ctx}/static/images/green.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<c:when test="${processStep eq '-1' && item.psiFlowCode eq '111111'}">
					<img src="${ctx}/static/images/green.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<c:when test="${sendProcessStep eq '-1' && item.psiFlowCode eq '333333'}">
					<img src="${ctx}/static/images/green.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<%--部分成功--%>
				<c:when test="${item.psiProcessStep eq confirmProcessStep && item.psiFlowCode eq '222222' }">
					<img src="${ctx}/static/images/red.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<c:when test="${item.psiProcessStep eq processStep && item.psiFlowCode eq '111111'}">
					<img src="${ctx}/static/images/red.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<c:when test="${item.psiProcessStep eq sendProcessStep && item.psiFlowCode eq '333333'}">
					<img src="${ctx}/static/images/red.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<c:when test="${item.psiProcessStep < confirmProcessStep && item.psiFlowCode eq '222222'}">
					<img src="${ctx}/static/images/green.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<c:when test="${item.psiProcessStep < processStep && item.psiFlowCode eq '111111'}">
					<img src="${ctx}/static/images/green.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<c:when test="${item.psiProcessStep < sendProcessStep && item.psiFlowCode eq '333333'}">
					<img src="${ctx}/static/images/green.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:when>
				<c:otherwise>
					<img src="${ctx}/static/images/gray.jpg" style="margin-top: 15px;" width="25px;" height="25px;" align="center">
				</c:otherwise>
			</c:choose>
			</c:if>
		</c:forEach>

		<%--<c:forEach items="${entity}" var = "item">--%>

			<%--<div style="width:65px;height:45px;border-radius:50%;background-color:#D8D8D8;text-align:center;padding-top:20px;float:left;margin-top: 20px;" id ="${item.psiProcessStep}${item.psiFlowCode}">${item.psiProcessName }</div>
			<div style = "float:left;height:5px;margin-top:45px;"><HR width=20 SIZE=3 NOSHADE></div>--%>
		<%--</c:forEach>--%>
	</div>
