<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sams.custom.mapper.ProductInfoMapper">

    <sql id="Base_Column_List1" >
		t.CI_CHANNEL_CODE,t.CI_CHANNEL_NAME,t.CI_SALE_AGENT_CODE,t.CI_MARKET_CODE,t.CI_CSDC_VER,t.CI_CHECK_ACCT_TYPE,t.CI_ECON_VERIFY_TYPE,t.CI_SZT_RECV_PATH,
		t.CI_SZT_SEND_PATH,t.CI_PER_ACCT_TYPE,t.CI_ORG_ACCT_TYPE,t.CI_DEAL_FILE,t.CI_VALID_FLAG,t.CI_CHECK_STATE,i.PI_PRODUCT_TYPE,i.PI_CHANNEL_PRODUCT_CODE,
		i.PI_CHANNEL_PRODUCT_NAME,i.PI_INDI_MIN_BIDS_AMT,i.PI_INST_MIN_BIDS_AMT,i.PI_INDI_BIDS_DIFF_AMT,i.PI_INST_BIDS_DIFF_AMT,i.PI_INDI_MAX_BIDS_AMT,
		i.PI_INST_MAX_BIDS_AMT,i.PI_INDI_MIN_APP_BIDS_AMT,i.PI_INST_MIN_APP_BIDS_AMT,i.PI_INDI_APP_BIDS_DIFF_AMT,i.PI_INST_APP_BIDS_DIFF_AMT,
		i.PI_INDI_MAX_APP_BIDS_AMT,i.PI_INST_MAX_APP_BIDS_AMT,i.PI_INDI_MIN_REDEEM_VOL,i.PI_INST_MIN_REDEEM_VOL,i.PI_INDI_REDEEM_DIFF,
		i.PI_INST_REDEEM_DIFF,i.PI_INDI_MAX_VOL,i.PI_INST_MAX_VOL,i.PI_INDI_MIN_VOL,i.PI_INST_MIN_VOL,i.PI_CHANNEL_RATE,i.PI_PAY_TYPE,
		i.PI_IPO_BEGIN_DATE,i.PI_IPO_END_DATE,i.PI_PRO_SETUP_DATE,i.PI_PRO_END_DATE,i.PI_PRO_YIELD_TYPE,i.PI_PRO_YIELD,i.PI_FEE_FLAG,
		i.PI_INDI_BUY_FLAG,i.PI_INST_BUY_FLAG,i.PI_PRO_CFM_WAY,i.PI_CHECK_STATE,i.PI_CURRENCY_TYPE,i.PI_ANNU_CAL_DAYS,i.PI_PRODUCT_TOTAL_SHARE,i.PI_Accu_explain_buy_limit,i.PI_ACTION,
		i.PI_MAX_AMOUNT_RAISED,i.PI_PRO_CALCULATE_TYPE,i.PI_TEMPLATE_CODE,i.PI_BATCH_NO,i.PI_CHANNEL_CODE,i.PI_SUB_CHANNEL_CODE
  </sql>

    <resultMap id="BaseResultMap" type="com.sams.custom.model.PProductInfo">
        <id column="PI_ID" jdbcType="DECIMAL" property="piId" />
        <result column="PI_PRODUCT_TYPE" jdbcType="VARCHAR" property="piProductType" />
        <result column="PI_CHANNEL_PRODUCT_CODE" jdbcType="VARCHAR" property="piChannelProductCode" />
        <result column="PI_CHANNEL_PRODUCT_NAME" jdbcType="VARCHAR" property="piChannelProductName" />
        <result column="PI_INDI_MIN_BIDS_AMT" jdbcType="DECIMAL" property="piIndiMinBidsAmt" />
        <result column="PI_INST_MIN_BIDS_AMT" jdbcType="DECIMAL" property="piInstMinBidsAmt" />
        <result column="PI_INDI_BIDS_DIFF_AMT" jdbcType="DECIMAL" property="piIndiBidsDiffAmt" />
        <result column="PI_INST_BIDS_DIFF_AMT" jdbcType="DECIMAL" property="piInstBidsDiffAmt" />
        <result column="PI_INDI_MAX_BIDS_AMT" jdbcType="DECIMAL" property="piIndiMaxBidsAmt" />
        <result column="PI_INST_MAX_BIDS_AMT" jdbcType="DECIMAL" property="piInstMaxBidsAmt" />
        <result column="PI_INDI_MIN_APP_BIDS_AMT" jdbcType="DECIMAL" property="piIndiMinAppBidsAmt" />
        <result column="PI_INST_MIN_APP_BIDS_AMT" jdbcType="DECIMAL" property="piInstMinAppBidsAmt" />
        <result column="PI_INDI_APP_BIDS_DIFF_AMT" jdbcType="DECIMAL" property="piIndiAppBidsDiffAmt" />
        <result column="PI_INST_APP_BIDS_DIFF_AMT" jdbcType="DECIMAL" property="piInstAppBidsDiffAmt" />
        <result column="PI_INDI_MAX_APP_BIDS_AMT" jdbcType="DECIMAL" property="piIndiMaxAppBidsAmt" />
        <result column="PI_INST_MAX_APP_BIDS_AMT" jdbcType="DECIMAL" property="piInstMaxAppBidsAmt" />
        <result column="PI_INDI_MIN_REDEEM_VOL" jdbcType="DECIMAL" property="piIndiMinRedeemVol" />
        <result column="PI_INST_MIN_REDEEM_VOL" jdbcType="DECIMAL" property="piInstMinRedeemVol" />
        <result column="PI_INDI_REDEEM_DIFF" jdbcType="DECIMAL" property="piIndiRedeemDiff" />
        <result column="PI_INST_REDEEM_DIFF" jdbcType="DECIMAL" property="piInstRedeemDiff" />
        <result column="PI_INDI_MAX_VOL" jdbcType="DECIMAL" property="piIndiMaxVol" />
        <result column="PI_INST_MAX_VOL" jdbcType="DECIMAL" property="piInstMaxVol" />
        <result column="PI_INDI_MIN_VOL" jdbcType="DECIMAL" property="piIndiMinVol" />
        <result column="PI_INST_MIN_VOL" jdbcType="DECIMAL" property="piInstMinVol" />
        <result column="PI_CHANNEL_RATE" jdbcType="DECIMAL" property="piChannelRate" />
        <result column="PI_PAY_TYPE" jdbcType="VARCHAR" property="piPayType" />
        <result column="PI_IPO_BEGIN_DATE" jdbcType="VARCHAR" property="piIpoBeginDate" />
        <result column="PI_IPO_END_DATE" jdbcType="VARCHAR" property="piIpoEndDate" />
        <result column="PI_PRO_SETUP_DATE" jdbcType="VARCHAR" property="piProSetupDate" />
        <result column="PI_PRO_END_DATE" jdbcType="VARCHAR" property="piProEndDate" />
        <result column="PI_PRO_YIELD_TYPE" jdbcType="VARCHAR" property="piProYieldType" />
        <result column="PI_PRO_YIELD" jdbcType="DECIMAL" property="piProYield" />
        <result column="PI_FEE_FLAG" jdbcType="VARCHAR" property="piFeeFlag" />
        <result column="PI_INDI_BUY_FLAG" jdbcType="VARCHAR" property="piIndiBuyFlag" />
        <result column="PI_INST_BUY_FLAG" jdbcType="VARCHAR" property="piInstBuyFlag" />
        <result column="PI_PRO_CFM_WAY" jdbcType="VARCHAR" property="piProCfmWay" />
        <result column="PI_CHECK_STATE" jdbcType="VARCHAR" property="piCheckState" />
        <result column="PI_CTIME" jdbcType="TIMESTAMP" property="piCtime" />
        <result column="PI_UTIME" jdbcType="TIMESTAMP" property="piUtime" />
        <result column="PI_CUSER" jdbcType="VARCHAR" property="piCuser" />
        <result column="PI_UUSER" jdbcType="VARCHAR" property="piUuser" />
        <result column="PI_CURRENCY_TYPE" jdbcType="VARCHAR" property="piCurrencyType" />
        <result column="PI_ANNU_CAL_DAYS" jdbcType="VARCHAR" property="piAnnuCalDays" />
        <result column="PI_PRODUCT_TOTAL_SHARE" jdbcType="VARCHAR" property="piProductTotalShare" />
        <result column="PI_VALID_FLAG" jdbcType="VARCHAR" property="piValidFlag" />
        <result column="PI_ACCU_EXPLAIN_BUY_LIMIT" property="piAccuExplainBuyLimit" jdbcType="DECIMAL"/>
        <result column="PI_MIN_INDI_AMOUNT_RAISED" property="piMinIndiAmountRaised" jdbcType="DECIMAL"/>
        <result column="PI_MAX_INDI_AMOUNT_RAISED" property="piMaxIndiAmountRaised" jdbcType="DECIMAL"/>
        <result column="PI_MIN_INST_AMOUNT_RAISED" property="piMinInstAmountRaised" jdbcType="DECIMAL"/>
        <result column="PI_MAX_INST_AMOUNT_RAISED" property="piMaxInstAmountRaised" jdbcType="DECIMAL"/>
        <result column="PI_MAX_AMOUNT_RAISED" property="piMaxAmountRaised" jdbcType="DECIMAL"/>
        <result column="PI_PRO_CALCULATE_TYPE"  property="piProCalculateType"  jdbcType="VARCHAR"/>
        <result column="PI_ACTION" property="piAction" jdbcType="VARCHAR"/>
        <result column="PI_TEMPLATE_CODE" property="piTemplateCode" jdbcType="VARCHAR"/>
        <result column="PI_BATCH_NO" property="piBatchNumber" jdbcType="VARCHAR"/>
        <result column="PI_CHANNEL_CODE" property="piChannelCode" jdbcType="VARCHAR"/>
        <result column="PI_SUB_CHANNEL_CODE" property="piSubChannelCode" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="ParProductResultMap" type="com.sams.custom.model.result.ParProductResult" extends="BaseResultMap">
        <result column="CI_CHANNEL_CODE" property="ciChannelCode" jdbcType="VARCHAR"/>
        <result column="DICTNAME" property="productTypeName" jdbcType="VARCHAR"/>
    </resultMap>

    <sql id="Base_Column_List">
		PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE AS piChannelProductCode, PI_CHANNEL_PRODUCT_NAME AS piChannelProductName,
    PI_INDI_MIN_BIDS_AMT, PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT, 
    PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, PI_INST_MIN_APP_BIDS_AMT, 
    PI_INDI_APP_BIDS_DIFF_AMT, PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, PI_INST_MAX_APP_BIDS_AMT, 
    PI_INDI_MIN_REDEEM_VOL, PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF, 
    PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, PI_INST_MIN_VOL, PI_CHANNEL_RATE, 
    PI_PAY_TYPE, PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, PI_PRO_END_DATE, 
    PI_PRO_YIELD_TYPE, PI_PRO_YIELD, PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG, 
    PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, PI_UTIME, PI_CUSER, PI_UUSER, PI_CURRENCY_TYPE, 
    PI_ANNU_CAL_DAYS, PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG,PI_ACCU_EXPLAIN_BUY_LIMIT,PI_MIN_INDI_AMOUNT_RAISED,PI_MIN_INST_AMOUNT_RAISED,PI_MAX_INST_AMOUNT_RAISED,
    PI_ACTION,PI_MAX_AMOUNT_RAISED,PI_PRO_CALCULATE_TYPE,PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE as piChannelCode,PI_SUB_CHANNEL_CODE
	</sql>


    <select id="selectByPrimaryKey1" parameterType="java.lang.Long" resultMap="BaseResultMap">
    select PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE, PI_CHANNEL_PRODUCT_NAME, 
    PI_INDI_MIN_BIDS_AMT, PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT, 
    PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, PI_INST_MIN_APP_BIDS_AMT, 
    PI_INDI_APP_BIDS_DIFF_AMT, PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, PI_INST_MAX_APP_BIDS_AMT, 
    PI_INDI_MIN_REDEEM_VOL, PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF, 
    PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, PI_INST_MIN_VOL, PI_CHANNEL_RATE, 
    PI_PAY_TYPE, PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, PI_PRO_END_DATE, 
    PI_PRO_YIELD_TYPE, PI_PRO_YIELD, PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG, 
    PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, PI_UTIME, PI_CUSER, PI_UUSER, PI_CURRENCY_TYPE, 
    PI_ANNU_CAL_DAYS,  PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG,PI_ACCU_EXPLAIN_BUY_LIMIT,PI_MIN_INDI_AMOUNT_RAISED,PI_MIN_INST_AMOUNT_RAISED,PI_MAX_INST_AMOUNT_RAISED,
    PI_ACTION,PI_MAX_AMOUNT_RAISED,PI_PRO_CALCULATE_TYPE,PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE,PI_SUB_CHANNEL_CODE
    from P_PRODUCT_INFO
    where PI_ID = #{piId,jdbcType=DECIMAL}
	</select>


    <delete id="deleteByPrimaryKey1" parameterType="java.lang.Long">
    delete from P_PRODUCT_INFO
    where PI_ID = #{piId,jdbcType=DECIMAL}
	</delete>

    <insert id="insert1" parameterType="com.sams.custom.model.PProductInfo" >
    insert into P_PRODUCT_INFO (PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE, 
      PI_CHANNEL_PRODUCT_NAME, PI_INDI_MIN_BIDS_AMT, 
      PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT, 
      PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, 
      PI_INST_MIN_APP_BIDS_AMT, PI_INDI_APP_BIDS_DIFF_AMT, 
      PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, 
      PI_INST_MAX_APP_BIDS_AMT, PI_INDI_MIN_REDEEM_VOL, 
      PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF, 
      PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, 
      PI_INST_MIN_VOL, PI_CHANNEL_RATE, PI_PAY_TYPE, 
      PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, 
      PI_PRO_END_DATE, PI_PRO_YIELD_TYPE, PI_PRO_YIELD, 
      PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG, 
      PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, 
      PI_UTIME, PI_CUSER, PI_UUSER, 
      PI_CURRENCY_TYPE, PI_ANNU_CAL_DAYS,  
      PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG, PI_ACCU_EXPLAIN_BUY_LIMIT, 
      PI_MIN_INDI_AMOUNT_RAISED, PI_MAX_INDI_AMOUNT_RAISED, 
      PI_MIN_INST_AMOUNT_RAISED, PI_MAX_INST_AMOUNT_RAISED,
      PI_ACTION,PI_MAX_AMOUNT_RAISED,PI_PRO_CALCULATE_TYPE,
      PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE,PI_SUB_CHANNEL_CODE
      )
    values (#{piId,jdbcType=DECIMAL}, #{piProductType,jdbcType=VARCHAR}, #{piChannelProductCode,jdbcType=VARCHAR}, 
      #{piChannelProductName,jdbcType=VARCHAR}, #{piIndiMinBidsAmt,jdbcType=DECIMAL}, 
      #{piInstMinBidsAmt,jdbcType=DECIMAL}, #{piIndiBidsDiffAmt,jdbcType=DECIMAL}, #{piInstBidsDiffAmt,jdbcType=DECIMAL}, 
      #{piIndiMaxBidsAmt,jdbcType=DECIMAL}, #{piInstMaxBidsAmt,jdbcType=DECIMAL}, #{piIndiMinAppBidsAmt,jdbcType=DECIMAL}, 
      #{piInstMinAppBidsAmt,jdbcType=DECIMAL}, #{piIndiAppBidsDiffAmt,jdbcType=DECIMAL}, 
      #{piInstAppBidsDiffAmt,jdbcType=DECIMAL}, #{piIndiMaxAppBidsAmt,jdbcType=DECIMAL}, 
      #{piInstMaxAppBidsAmt,jdbcType=DECIMAL}, #{piIndiMinRedeemVol,jdbcType=DECIMAL}, 
      #{piInstMinRedeemVol,jdbcType=DECIMAL}, #{piIndiRedeemDiff,jdbcType=DECIMAL}, #{piInstRedeemDiff,jdbcType=DECIMAL}, 
      #{piIndiMaxVol,jdbcType=DECIMAL}, #{piInstMaxVol,jdbcType=DECIMAL}, #{piIndiMinVol,jdbcType=DECIMAL}, 
      #{piInstMinVol,jdbcType=DECIMAL}, #{piChannelRate,jdbcType=DECIMAL}, #{piPayType,jdbcType=VARCHAR}, 
      #{piIpoBeginDate,jdbcType=VARCHAR}, #{piIpoEndDate,jdbcType=VARCHAR}, #{piProSetupDate,jdbcType=VARCHAR}, 
      #{piProEndDate,jdbcType=VARCHAR}, #{piProYieldType,jdbcType=VARCHAR}, #{piProYield,jdbcType=DECIMAL}, 
      #{piFeeFlag,jdbcType=VARCHAR}, #{piIndiBuyFlag,jdbcType=VARCHAR}, #{piInstBuyFlag,jdbcType=VARCHAR}, 
      #{piProCfmWay,jdbcType=VARCHAR}, #{piCheckState,jdbcType=VARCHAR}, #{piCtime,jdbcType=TIMESTAMP}, 
      #{piUtime,jdbcType=TIMESTAMP}, #{piCuser,jdbcType=VARCHAR}, #{piUuser,jdbcType=VARCHAR}, 
      #{piCurrencyType,jdbcType=VARCHAR}, #{piAnnuCalDays,jdbcType=VARCHAR},  
      #{piProductTotalShare,jdbcType=VARCHAR}, #{piValidFlag,jdbcType=VARCHAR}, #{piAccuExplainBuyLimit,jdbcType=DECIMAL}, 
      #{piMinIndiAmountRaised,jdbcType=DECIMAL}, #{piMaxIndiAmountRaised,jdbcType=DECIMAL}, 
      #{piMinInstAmountRaised,jdbcType=DECIMAL}, #{piMaxInstAmountRaised,jdbcType=DECIMAL},
      #{piAction,jdbcType=DECIMAL}, #{piMaxAmountRaised,jdbcType=DECIMAL},#{piProCalculateType,jdbcType=DECIMAL},#{piTemplateCode,jdbcType=DECIMAL},#{piBatchNumber,jdbcType=VARCHAR},
      #{piChannelCode,jdbcType=VARCHAR},#{piSubChannelCode,jdbcType=VARCHAR}
      )
  </insert>

    <update id="updateCodeAndType" parameterType="com.sams.custom.model.FundMarketCustom">
        update P_PRODUCT_INFO
        set  PI_VALID_FLAG = #{piValidFlag,jdbcType=VARCHAR}
        where 1=1
        <if  test="piChannelProductCode != null">
            and PI_CHANNEL_PRODUCT_CODE = #{piChannelProductCode,jdbcType=VARCHAR}
        </if>
        <if  test="piProductType != null">
            and PI_PRODUCT_TYPE = #{piProductType,jdbcType=VARCHAR}
        </if>
    </update>

    <update id="updateBatch"  parameterType="java.util.List">
        <foreach collection="list" item="item" index="index" open="" close="" separator=";">
            update P_PRODUCT_INFO
            <set>
                PI_VALID_FLAG = #{item.piValidFlag}
            </set>
            where PI_CHANNEL_PRODUCT_CODE = #{item.piChannelProductCode} and PI_PRODUCT_TYPE = #{item.piProductType}
        </foreach>
    </update>

    <update id="updateByPrimaryKey1" parameterType="com.sams.custom.model.PProductInfo">
    update P_PRODUCT_INFO
    set PI_PRODUCT_TYPE = #{piProductType,jdbcType=VARCHAR},
      PI_CHANNEL_PRODUCT_CODE = #{piChannelProductCode,jdbcType=VARCHAR},
      PI_CHANNEL_PRODUCT_NAME = #{piChannelProductName,jdbcType=VARCHAR},
      PI_INDI_MIN_BIDS_AMT = #{piIndiMinBidsAmt,jdbcType=DECIMAL},
      PI_INST_MIN_BIDS_AMT = #{piInstMinBidsAmt,jdbcType=DECIMAL},
      PI_INDI_BIDS_DIFF_AMT = #{piIndiBidsDiffAmt,jdbcType=DECIMAL},
      PI_INST_BIDS_DIFF_AMT = #{piInstBidsDiffAmt,jdbcType=DECIMAL},
      PI_INDI_MAX_BIDS_AMT = #{piIndiMaxBidsAmt,jdbcType=DECIMAL},
      PI_INST_MAX_BIDS_AMT = #{piInstMaxBidsAmt,jdbcType=DECIMAL},
      PI_INDI_MIN_APP_BIDS_AMT = #{piIndiMinAppBidsAmt,jdbcType=DECIMAL},
      PI_INST_MIN_APP_BIDS_AMT = #{piInstMinAppBidsAmt,jdbcType=DECIMAL},
      PI_INDI_APP_BIDS_DIFF_AMT = #{piIndiAppBidsDiffAmt,jdbcType=DECIMAL},
      PI_INST_APP_BIDS_DIFF_AMT = #{piInstAppBidsDiffAmt,jdbcType=DECIMAL},
      PI_INDI_MAX_APP_BIDS_AMT = #{piIndiMaxAppBidsAmt,jdbcType=DECIMAL},
      PI_INST_MAX_APP_BIDS_AMT = #{piInstMaxAppBidsAmt,jdbcType=DECIMAL},
      PI_INDI_MIN_REDEEM_VOL = #{piIndiMinRedeemVol,jdbcType=DECIMAL},
      PI_INST_MIN_REDEEM_VOL = #{piInstMinRedeemVol,jdbcType=DECIMAL},
      PI_INDI_REDEEM_DIFF = #{piIndiRedeemDiff,jdbcType=DECIMAL},
      PI_INST_REDEEM_DIFF = #{piInstRedeemDiff,jdbcType=DECIMAL},
      PI_INDI_MAX_VOL = #{piIndiMaxVol,jdbcType=DECIMAL},
      PI_INST_MAX_VOL = #{piInstMaxVol,jdbcType=DECIMAL},
      PI_INDI_MIN_VOL = #{piIndiMinVol,jdbcType=DECIMAL},
      PI_INST_MIN_VOL = #{piInstMinVol,jdbcType=DECIMAL},
      PI_CHANNEL_RATE = #{piChannelRate,jdbcType=DECIMAL},
      PI_PAY_TYPE = #{piPayType,jdbcType=VARCHAR},
      PI_IPO_BEGIN_DATE = #{piIpoBeginDate,jdbcType=VARCHAR},
      PI_IPO_END_DATE = #{piIpoEndDate,jdbcType=VARCHAR},
      PI_PRO_SETUP_DATE = #{piProSetupDate,jdbcType=VARCHAR},
      PI_PRO_END_DATE = #{piProEndDate,jdbcType=VARCHAR},
      PI_PRO_YIELD_TYPE = #{piProYieldType,jdbcType=VARCHAR},
      PI_PRO_YIELD = #{piProYield,jdbcType=DECIMAL},
      PI_FEE_FLAG = #{piFeeFlag,jdbcType=VARCHAR},
      PI_INDI_BUY_FLAG = #{piIndiBuyFlag,jdbcType=VARCHAR},
      PI_INST_BUY_FLAG = #{piInstBuyFlag,jdbcType=VARCHAR},
      PI_PRO_CFM_WAY = #{piProCfmWay,jdbcType=VARCHAR},
      PI_CHECK_STATE = #{piCheckState,jdbcType=VARCHAR},
      PI_CTIME = #{piCtime,jdbcType=TIMESTAMP},
      PI_UTIME = #{piUtime,jdbcType=TIMESTAMP},
      PI_CUSER = #{piCuser,jdbcType=VARCHAR},
      PI_UUSER = #{piUuser,jdbcType=VARCHAR},
      PI_CURRENCY_TYPE = #{piCurrencyType,jdbcType=VARCHAR},
      PI_ANNU_CAL_DAYS = #{piAnnuCalDays,jdbcType=VARCHAR},

      PI_PRODUCT_TOTAL_SHARE = #{piProductTotalShare,jdbcType=VARCHAR},
      PI_VALID_FLAG = #{piValidFlag,jdbcType=VARCHAR},
      PI_Accu_explain_buy_limit = #{piAccuExplainBuyLimit,jdbcType=DECIMAL},
      PI_MIN_INDI_AMOUNT_RAISED = #{piMinIndiAmountRaised,jdbcType=DECIMAL},
      PI_MAX_INDI_AMOUNT_RAISED = #{piMaxIndiAmountRaised,jdbcType=DECIMAL},
      PI_MIN_INST_AMOUNT_RAISED = #{piMinInstAmountRaised,jdbcType=DECIMAL},
      PI_MAX_INST_AMOUNT_RAISED = #{piMaxInstAmountRaised,jdbcType=DECIMAL},
      PI_MAX_AMOUNT_RAISED = #{piMaxAmountRaised,jdbcType=DECIMAL},
      PI_ACTION = #{piAction,jdbcType=VARCHAR},
      PI_PRO_CALCULATE_TYPE = #{piProCalculateType,jdbcType=VARCHAR},
      PI_TEMPLATE_CODE = #{piTemplateCode,jdbcType=VARCHAR},
      PI_BATCH_NO = #{piBatchNumber,jdbcType=VARCHAR},
      PI_CHANNEL_CODE = #{piChannelCode,jdbcType=VARCHAR},
      PI_SUB_CHANNEL_CODE = #{piSubChannelCode,jdbcType=VARCHAR}
    where PI_ID = #{piId,jdbcType=DECIMAL}
	</update>

    <select id="selectByProductCode" parameterType="java.lang.String" resultMap="BaseResultMap">
    select PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE, PI_CHANNEL_PRODUCT_NAME,
    PI_INDI_MIN_BIDS_AMT, PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT,
    PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, PI_INST_MIN_APP_BIDS_AMT,
    PI_INDI_APP_BIDS_DIFF_AMT, PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, PI_INST_MAX_APP_BIDS_AMT,
    PI_INDI_MIN_REDEEM_VOL, PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF,
    PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, PI_INST_MIN_VOL, PI_CHANNEL_RATE,
    PI_PAY_TYPE, PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, PI_PRO_END_DATE,
    PI_PRO_YIELD_TYPE, PI_PRO_YIELD, PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG,
    PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, PI_UTIME, PI_CUSER, PI_UUSER, PI_CURRENCY_TYPE,
    PI_ANNU_CAL_DAYS,  PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG,PI_Accu_explain_buy_limit,PI_MIN_INDI_AMOUNT_RAISED,PI_MIN_INST_AMOUNT_RAISED,PI_MAX_INST_AMOUNT_RAISED,
    PI_MAX_AMOUNT_RAISED,PI_ACTION,PI_PRO_CALCULATE_TYPE,PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE,PI_SUB_CHANNEL_CODE
    from P_PRODUCT_INFO
      where PI_CHANNEL_PRODUCT_CODE = #{PRODUCTCODE,jdbcType=DECIMAL}
	</select>


    <select id="selectByProductCodeBatchNo" parameterType="hashMap" resultMap="BaseResultMap">
    select PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE, PI_CHANNEL_PRODUCT_NAME,
    PI_INDI_MIN_BIDS_AMT, PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT,
    PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, PI_INST_MIN_APP_BIDS_AMT,
    PI_INDI_APP_BIDS_DIFF_AMT, PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, PI_INST_MAX_APP_BIDS_AMT,
    PI_INDI_MIN_REDEEM_VOL, PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF,
    PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, PI_INST_MIN_VOL, PI_CHANNEL_RATE,
    PI_PAY_TYPE, PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, PI_PRO_END_DATE,
    PI_PRO_YIELD_TYPE, PI_PRO_YIELD, PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG,
    PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, PI_UTIME, PI_CUSER, PI_UUSER, PI_CURRENCY_TYPE,
    PI_ANNU_CAL_DAYS,  PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG,PI_Accu_explain_buy_limit,PI_MIN_INDI_AMOUNT_RAISED,PI_MIN_INST_AMOUNT_RAISED,PI_MAX_INST_AMOUNT_RAISED,
    PI_MAX_AMOUNT_RAISED,PI_ACTION,PI_PRO_CALCULATE_TYPE,PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE,PI_SUB_CHANNEL_CODE
    from P_PRODUCT_INFO
      where PI_CHANNEL_PRODUCT_CODE = #{PRODUCTCODE,jdbcType=VARCHAR}
     and PI_CHANNEL_CODE=#{CHANNELCODE,jdbcType=VARCHAR}
     and PI_VALID_FLAG not in('00','99')
     and PI_CHECK_STATE='01'
     and PI_BATCH_NO=#{BATCHNO,jdbcType=VARCHAR}
	</select>

    <select id="selectByProductCodeList" parameterType="Map" resultMap="BaseResultMap">
    select PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE, PI_CHANNEL_PRODUCT_NAME,
    PI_INDI_MIN_BIDS_AMT, PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT,
    PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, PI_INST_MIN_APP_BIDS_AMT,
    PI_INDI_APP_BIDS_DIFF_AMT, PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, PI_INST_MAX_APP_BIDS_AMT,
    PI_INDI_MIN_REDEEM_VOL, PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF,
    PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, PI_INST_MIN_VOL, PI_CHANNEL_RATE,
    PI_PAY_TYPE, PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, PI_PRO_END_DATE,
    PI_PRO_YIELD_TYPE, PI_PRO_YIELD, PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG,
    PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, PI_UTIME, PI_CUSER, PI_UUSER, PI_CURRENCY_TYPE,
    PI_ANNU_CAL_DAYS,  PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG,PI_Accu_explain_buy_limit,PI_MIN_INDI_AMOUNT_RAISED,PI_MIN_INST_AMOUNT_RAISED,PI_MAX_INST_AMOUNT_RAISED,
    PI_MAX_AMOUNT_RAISED,PI_ACTION,PI_PRO_CALCULATE_TYPE,PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE,PI_SUB_CHANNEL_CODE
    from P_PRODUCT_INFO
    where PI_CHANNEL_PRODUCT_CODE = #{PRODUCTCODE,jdbcType=DECIMAL} and PI_CHANNEL_CODE = #{CHANNELCODE,jdbcType=DECIMAL}
	</select>

    <select id="selectBatchProductInfo" parameterType="Map" resultMap="BaseResultMap">
    select PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE, PI_CHANNEL_PRODUCT_NAME,
    PI_INDI_MIN_BIDS_AMT, PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT,
    PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, PI_INST_MIN_APP_BIDS_AMT,
    PI_INDI_APP_BIDS_DIFF_AMT, PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, PI_INST_MAX_APP_BIDS_AMT,
    PI_INDI_MIN_REDEEM_VOL, PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF,
    PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, PI_INST_MIN_VOL, PI_CHANNEL_RATE,
    PI_PAY_TYPE, PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, PI_PRO_END_DATE,
    PI_PRO_YIELD_TYPE, PI_PRO_YIELD, PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG,
    PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, PI_UTIME, PI_CUSER, PI_UUSER, PI_CURRENCY_TYPE,
    PI_ANNU_CAL_DAYS,  PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG,PI_Accu_explain_buy_limit,PI_MIN_INDI_AMOUNT_RAISED,PI_MIN_INST_AMOUNT_RAISED,PI_MAX_INST_AMOUNT_RAISED,
    PI_MAX_AMOUNT_RAISED,PI_ACTION,PI_PRO_CALCULATE_TYPE,PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE,PI_SUB_CHANNEL_CODE
    from P_PRODUCT_INFO,p_channel_product
    where PI_CHANNEL_PRODUCT_CODE = CP_CHANNEL_PRODUCT_CODE and  PI_CHANNEL_PRODUCT_CODE = #{PRODUCTCODE,jdbcType=DECIMAL} and PI_CHANNEL_CODE = #{CHANNELCODE,jdbcType=DECIMAL}
    and pi_valid_flag not in('99','00') and pi_check_state='01' and cp_valid_flag='01' and cp_check_state='01'
	</select>

    <select id="selectAll" resultMap="BaseResultMap">
    select PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE, PI_CHANNEL_PRODUCT_NAME,
    PI_INDI_MIN_BIDS_AMT, PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT,
    PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, PI_INST_MIN_APP_BIDS_AMT,
    PI_INDI_APP_BIDS_DIFF_AMT, PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, PI_INST_MAX_APP_BIDS_AMT,
    PI_INDI_MIN_REDEEM_VOL, PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF,
    PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, PI_INST_MIN_VOL, PI_CHANNEL_RATE,
    PI_PAY_TYPE, PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, PI_PRO_END_DATE,
    PI_PRO_YIELD_TYPE, PI_PRO_YIELD, PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG,
    PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, PI_UTIME, PI_CUSER, PI_UUSER, PI_CURRENCY_TYPE,
    PI_ANNU_CAL_DAYS,  PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG,PI_Accu_explain_buy_limit,PI_MIN_INDI_AMOUNT_RAISED,PI_MIN_INST_AMOUNT_RAISED,PI_MAX_INST_AMOUNT_RAISED,
    PI_MAX_AMOUNT_RAISED,PI_ACTION,PI_PRO_CALCULATE_TYPE,PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE,PI_SUB_CHANNEL_CODE
    from P_PRODUCT_INFO
	</select>

    <sql id="BaseColumnForOrder">
        PI_ID piId,
        PI_PRODUCT_TYPE piProductType,
        PI_CHANNEL_PRODUCT_CODE piChannelProductCode,
        PI_CHANNEL_PRODUCT_NAME piChannelProductName,
        PI_INDI_MIN_BIDS_AMT piIndiMinBidsAmt,
        PI_INST_MIN_BIDS_AMT piInstMinBidsAmt,
        PI_INDI_BIDS_DIFF_AMT piIndiBidsDiffAmt,
        PI_INST_BIDS_DIFF_AMT piInstBidsDiffAmt,
        PI_INDI_MAX_BIDS_AMT piIndiMaxBidsAmt,
        PI_INST_MAX_BIDS_AMT piInstMaxBidsAmt,
        PI_INDI_MIN_APP_BIDS_AMT piIndiMinAppBidsAmt,
        PI_INST_MIN_APP_BIDS_AMT piInstMinAppBidsAmt,
        PI_INDI_APP_BIDS_DIFF_AMT piIndiAppBidsDiffAmt,
        PI_INST_APP_BIDS_DIFF_AMT piInstAppBidsDiffAmt,
        PI_INDI_MAX_APP_BIDS_AMT piIndiMaxAppBidsAmt,
        PI_INST_MAX_APP_BIDS_AMT piInstMaxAppBidsAmt,
        PI_INDI_MIN_REDEEM_VOL piIndiMinRedeemVol,
        PI_INST_MIN_REDEEM_VOL piInstMinRedeemVol,
        PI_INDI_REDEEM_DIFF piIndiRedeemDiff,
        PI_INST_REDEEM_DIFF piInstRedeemDiff,
        PI_INDI_MAX_VOL piIndiMaxVol,
        PI_INST_MAX_VOL piInstMaxVol,
        PI_INDI_MIN_VOL piIndiMinVol,
        PI_INST_MIN_VOL piInstMinVol,
        PI_CHANNEL_RATE piChannelRate,
        PI_PAY_TYPE piPayType,
        PI_IPO_BEGIN_DATE piIpoBeginDate,
        PI_IPO_END_DATE piIpoEndDate,
        PI_PRO_SETUP_DATE piProSetupDate,
        PI_PRO_END_DATE piProEndDate,
        PI_PRO_YIELD_TYPE piProYieldType,
        PI_PRO_YIELD piProYield,
        PI_FEE_FLAG piFeeFlag,
        PI_INDI_BUY_FLAG piIndiBuyFlag,
        PI_INST_BUY_FLAG piInstBuyFlag,
        PI_PRO_CFM_WAY piProCfmWay,
        PI_CHECK_STATE piCheckState,
        PI_CTIME piCtime,
        PI_UTIME piUtime,
        PI_CUSER piCuser,
        PI_UUSER piUuser,
        PI_CURRENCY_TYPE piCurrencyType,
        PI_ANNU_CAL_DAYS piAnnuCalDays,
        PI_PRODUCT_TOTAL_SHARE piProductTotalShare,
        PI_VALID_FLAG piValidFlag,
        PI_ACCU_EXPLAIN_BUY_LIMIT piAccuExplainBuyLimit,
        PI_MIN_INDI_AMOUNT_RAISED piMinIndiAmountRaised,
        PI_MAX_INDI_AMOUNT_RAISED piMaxIndiAmountRaised,
        PI_MIN_INST_AMOUNT_RAISED piMinInstAmountRaised,
        PI_MAX_INST_AMOUNT_RAISED piMaxInstAmountRaised,
        PI_MAX_AMOUNT_RAISED piMaxAmountRaised,
        PI_PRO_CALCULATE_TYPE piProCalculateType,
        PI_ACTION piAction,
        PI_TEMPLATE_CODE piTemplateCode,
        PI_BATCH_NO piBatchNumber,
        PI_CHANNEL_CODE piChannelCode,
        PI_SUB_CHANNEL_CODE piSubChannelCode
    </sql>
    <select id="findPProductInfoCondition" parameterType="java.util.Map"  resultMap="ParProductResultMap">
        select
        <include refid="BaseColumnForOrder"/>,
        (SELECT DICT_NAME DICTNAME
        FROM SYS_DICT D
        WHERE D.DICT_CODE = i.PI_PRODUCT_TYPE
        and D.DICT_TYPE = 'fundType') productTypeName
        from  P_PRODUCT_INFO i
        where (i.PI_VALID_FLAG !='99' or i.PI_CHECK_STATE !='01')
        <if test=" condition.piChannelProductCode != null and condition.piChannelProductCode != ''  ">
            and i.PI_CHANNEL_PRODUCT_CODE like  ('%'|| #{condition.piChannelProductCode} ||'%')
        </if>
        <if test=" condition.piChannelCode != null and condition.piChannelCode != ''  ">
            and i.PI_CHANNEL_CODE = #{condition.piChannelCode}
        </if>
        <if test=" condition.piProductType != null and condition.piProductType != ''  ">
            and i.PI_PRODUCT_TYPE = #{condition.piProductType}
        </if>
        <if test=" condition.piValidFlag != null and condition.piValidFlag != '' ">
            and i.PI_VALID_FLAG = #{condition.piValidFlag}
            <!-- <if test=" condition.piValidFlag =='01' ">
              and i.PI_VALID_FLAG = #{condition.piValidFlag}
            </if>
            <if test=" condition.piValidFlag =='00' or condition.piValidFlag =='10' ">
              and i.PI_VALID_FLAG in ('00','10')
            </if> -->
        </if>
        <if test=" condition.piCheckState != null and condition.piCheckState != '' ">
            and i.PI_CHECK_STATE = #{condition.piCheckState}
        </if>
        <if test="pageInfo.sort != null and pageInfo.sort != ''">
            order by ${pageInfo.sort} ${pageInfo.order}
        </if>
    </select>

    <select id="selectByConditionCount" parameterType="java.util.Map" resultType="long">
        select count(*)
        from P_PRODUCT_INFO
        where 1=1 and PI_VALID_FLAG !='99'
        <if test="piBatchNumber != null and piBatchNumber != ''">
            and PI_BATCH_NO = #{piBatchNumber,jdbcType = VARCHAR}
        </if>
        <if test="piBatchNumber != null and piBatchNumber != ''">
            and PI_CHANNEL_CODE = #{CHANNELCODE,jdbcType = VARCHAR}
        </if>
        <if  test="piChannelProductCode != null and piChannelProductCode !='' ">
            and PI_CHANNEL_PRODUCT_CODE = #{piChannelProductCode,jdbcType=VARCHAR}
        </if>
        <if  test="piChannelProductName != null and piChannelProductName !='' ">
            and PI_CHANNEL_PRODUCT_NAME like ('%'|| #{piChannelProductName,jdbcType=VARCHAR} ||'%')
        </if>
        <if  test="piProductType != null and piProductType !='' ">
            and PI_PRODUCT_TYPE like ('%'|| #{piProductType,jdbcType=VARCHAR} ||'%')
        </if>
        <if  test="piTemplateCode != null and piTemplateCode !='' ">
            and PI_TEMPLATE_CODE like ('%'|| #{piTemplateCode,jdbcType=VARCHAR} ||'%')
        </if>
        <if  test="id != null and id !='' ">
            and PI_ID != #{id,jdbcType=VARCHAR}
        </if>


    </select>

    <select id="selectAllByChannelCodeAndFundCode" resultType="hashMap" parameterType="hashMap">
	select * from p_channel_product c
		where c.cp_channel_product_code=#{FUNDCODE,jdbcType=VARCHAR}
		and c.cp_channel_code=#{CHANNELCODE,jdbcType=VARCHAR}
		and CP_TA_PRODUCT_CODE = #{PRODUCTCODE,jdbcType = VARCHAR}
		and c.cp_valid_flag='01'
        and c.cp_check_state='01'
        and c.cp_batch_no=#{BATCHNO,jdbcType = VARCHAR}
  </select>

    <select id="selectFundCodePropertyByFundCode" resultType="hashMap" parameterType="hashMap">
        <!-- select t.c_fundcode,t.c_property from ta_tfundinfo t,p_channel_product c
            where t.c_fundcode=c.cp_ta_product_code
            and c.cp_channel_product_code=#{FUNDCODE,jdbcType=VARCHAR}
            and c.cp_channel_code=#{CHANNELCODE,jdbcType=VARCHAR}
            and c.CP_CHECK_STATE='01'
            and c.CP_VALID_FLAG='01'
            AND C.CP_VALID_FLAG = '01'
            AND C.CP_ACTION = '01'
            and c.cp_batch_no=#{BATCHNO,jdbcType=VARCHAR} -->
        select t.c_property  from ta_tfundinfo t where t.c_fundcode=#{TAPRODUCTCODE,jdbcType=VARCHAR}
    </select>

    <select id="selectCommonSharesByFundAcco" resultType="hashMap" parameterType="hashMap">
        SELECT T.C_FUNDACCO,T2.C_TRUSTAGENCYNO,T.C_FUNDCODE,T.C_FUNDNAME,T.C_PRODUCTTYPE,
        T.L_CONTRACTSERIALNO, T.C_TRUSTCONTRACTID,
        t.f_remainshares_sams<!--数据中心增加字段 替换t.f_remainshares --> F_REMAINSHARES,T.C_PROFITCLASS,T.C_PROFITCLASSNAME,T.F_PROFIT
        FROM TJ_CONTRACTDETAILS T, TA_TTRUSTCONTRACTDETAILS T2 WHERE T.L_CONTRACTSERIALNO=T2.L_SERIALNO
        AND T.C_FUNDCODE =(select c.cp_ta_product_code from p_channel_product c
        where c.cp_channel_code=#{CHANNELCODE,jdbcType=VARCHAR}
        and c.cp_channel_product_code=#{FUNDCODE,jdbcType=VARCHAR}
        and c.CP_CHECK_STATE='01'
        and c.CP_VALID_FLAG='01'
        and c.cp_batch_no=#{BATCHNO,jdbcType=VARCHAR})
        AND T.C_FUNDACCO = #{TAACCOUNTID,jdbcType=VARCHAR}
        <if test="L_CONTRACTSERIALNO != null and L_CONTRACTSERIALNO != ''">
            AND T.L_CONTRACTSERIALNO = #{L_CONTRACTSERIALNO,jdbcType=VARCHAR}
        </if>
        <if test="C_TRUSTCONTRACTID != null and C_TRUSTCONTRACTID != ''">
            AND T.C_TRUSTCONTRACTID = #{C_TRUSTCONTRACTID,jdbcType=VARCHAR}
        </if>
    </select>

    <select id="selectActSharesByFundAcco" resultType="hashMap" parameterType="hashMap">
        SELECT T.C_FUNDACCO,T2.C_TRUSTAGENCYNO,T.C_FUNDCODE,T.C_FUNDNAME, T.C_PRODUCTTYPE,
        T.L_CONTRACTSERIALNO, T.C_TRUSTCONTRACTID,
        T.F_REMAINSHARES, T.F_UNCONFIRMBAL, T.F_UNCONFIRMSHARES,T.F_INCOME
        FROM TJ_CONTRACTFUND T, TA_TTRUSTCONTRACTDETAILS T2 WHERE T.L_CONTRACTSERIALNO=T2.L_SERIALNO
        AND T.C_FUNDCODE = (select c.cp_ta_product_code from p_channel_product c
        where c.cp_channel_code=#{CHANNELCODE,jdbcType=VARCHAR}
        and c.cp_channel_product_code=#{FUNDCODE,jdbcType=VARCHAR}
        and c.cp_check_state='01'
        and c.cp_valid_flag='01'
        and c.cp_batch_no=#{BATCHNO,jdbcType=VARCHAR}
        )
        AND T.C_FUNDACCO = #{TAACCOUNTID,jdbcType=VARCHAR}
        <if test="L_CONTRACTSERIALNO != null and L_CONTRACTSERIALNO != ''">
            AND T.L_CONTRACTSERIALNO = #{L_CONTRACTSERIALNO}
        </if>
        <if test="C_TRUSTCONTRACTID != null and C_TRUSTCONTRACTID != ''">
            AND T.C_TRUSTCONTRACTID = #{C_TRUSTCONTRACTID,jdbcType=VARCHAR}
        </if>
    </select>

    <select id="selectPositionByFundAcco" resultType="hashMap" parameterType="hashMap">
        SELECT  sum(T.F_REMAINSHARES) F_REMAINSHARES,
        sum(T.F_UNCONFIRMBAL) F_UNCONFIRMBAL,
        sum(T.F_UNCONFIRMSHARES) F_UNCONFIRMSHARES
        FROM TJ_CONTRACTFUND T, TA_TTRUSTCONTRACTDETAILS T2 WHERE T.L_CONTRACTSERIALNO=T2.L_SERIALNO
        <if test="FUNDCODE != null and FUNDCODE != ''">
            AND T.C_FUNDCODE in (select c.cp_ta_product_code from p_channel_product c
            where c.cp_channel_code=#{CHANNELCODE,jdbcType=VARCHAR}
            and c.cp_channel_product_code=#{FUNDCODE,jdbcType=VARCHAR})
        </if>
        AND T.C_FUNDACCO = #{TAACCOUNTID,jdbcType=VARCHAR}
    </select>

    <select id="selectNoCurrenyPosition" resultType="hashMap" parameterType="hashMap">
        select sum(t.f_remainshares_sams) F_REMAINSHARES from TJ_CONTRACTDETAILS  T, TA_TTRUSTCONTRACTDETAILS  T2  WHERE T.L_CONTRACTSERIALNO = T2.L_SERIALNO
        <if test="FUNDCODE != null and FUNDCODE != ''">
            AND T.C_FUNDCODE in (select c.cp_ta_product_code from p_channel_product c
            where c.cp_channel_code=#{CHANNELCODE,jdbcType=VARCHAR}
            and c.cp_channel_product_code=#{FUNDCODE,jdbcType=VARCHAR})
        </if>
        and t.c_fundacco = #{TAACCOUNTID,jdbcType=VARCHAR}
    </select>

    <select id="selectProYield" resultType="hashMap" parameterType="hashMap">
	select P.PI_PRO_YIELD_TYPE         PROYIELDTYPE,
       P.PI_PRO_YIELD              PROYIELD,
       P.PI_PRODUCT_TYPE           PRODUCTTYPE,
       P.PI_INDI_BUY_FLAG          INDIBUYFLAG,
       P.PI_INST_BUY_FLAG          INSTBUYFLAG,
       P.PI_INDI_MIN_BIDS_AMT      INDIMINBIDSAMT,
       P.PI_INDI_BIDS_DIFF_AMT     INDIBIDSDIFFAMT,
       P.PI_INDI_MAX_BIDS_AMT      INDIMAXBIDSAMT,
       P.PI_INST_MIN_BIDS_AMT      INSTMINBIDSAMT,
       P.PI_INST_BIDS_DIFF_AMT     INSTBIDSDIFFAMT,
       P.PI_INST_MAX_BIDS_AMT      INSTMAXBIDSAMT,
       P.PI_INDI_MIN_APP_BIDS_AMT  INDIMINAPPBIDSAMT,
       P.PI_INDI_APP_BIDS_DIFF_AMT INDIAPPBIDSDIFFAMT,
       P.PI_INDI_MAX_APP_BIDS_AMT  INDIMAXAPPBIDSAMT,
       P.PI_INST_MIN_APP_BIDS_AMT  INSTMINAPPBIDSAMT,
       P.PI_INST_APP_BIDS_DIFF_AMT INSTAPPBIDSDIFFAMT,
       P.PI_INST_MAX_APP_BIDS_AMT  INSTMAXAPPBIDSAMT,
       P.PI_INDI_MIN_VOL           INDIMINVOL,
       P.PI_INDI_MAX_VOL           INDIMAXVOL,
       P.PI_INST_MAX_VOL           INSTMAXVOL,
       P.PI_INST_MIN_VOL           INSTMINVOL,
       P.PI_PRO_CFM_WAY            PROCFMWAY,
       P.PI_PRO_SETUP_DATE         PROSETUPDATE,
       P.PI_INST_MIN_REDEEM_VOL    PI_INST_MIN_REDEEM_VOL,
       P.PI_INST_REDEEM_DIFF       PI_INST_REDEEM_DIFF,
       P.PI_INST_MIN_VOL           PI_INST_MIN_VOL,
       P.PI_INDI_MIN_REDEEM_VOL    PI_INDI_MIN_REDEEM_VOL,
       P.PI_INDI_REDEEM_DIFF       PI_INDI_REDEEM_DIFF,
       P.PI_INDI_MIN_VOL           PI_INDI_MIN_VOL,
       P.PI_FEE_FLAG               FEEFLAG,
       P.PI_PAY_TYPE               PAYTYPE,
       P.PI_PRODUCT_TYPE           PRODUCTTYPE,
       P.PI_PRO_CFM_WAY            PROCFMWAY,
       P.PI_MAX_AMOUNT_RAISED      MAXAMOUNTRAISED,
       C.CP_TA_PRODUCT_CODE        TAPRODUCTCODE,
		(select I.CI_MARKET_CODE from P_CHANNEL_INFO I where I.CI_CHANNEL_CODE=P.PI_CHANNEL_CODE and I.CI_CHANNEL_CODE = C.CP_CHANNEL_CODE  AND I.CI_VALID_FLAG = '01'  AND I.CI_CHECK_STATE = '01') MARKETCODE,       
       p.PI_BATCH_NO   BATCHNO
  FROM P_CHANNEL_PRODUCT C, P_PRODUCT_INFO P 
 WHERE C.CP_CHANNEL_PRODUCT_CODE = P.PI_CHANNEL_PRODUCT_CODE
 and c.cp_channel_code = p.pi_channel_code 
   AND C.CP_CHECK_STATE = '01'
	 AND C.CP_VALID_FLAG = '01'
   AND P.PI_VALID_FLAG = '01'
   AND P.PI_CHECK_STATE = '01'
	AND C.CP_CHANNEL_CODE=#{CHANNELCODE,jdbcType=VARCHAR}
	AND P.PI_CHANNEL_PRODUCT_CODE=#{FUNDCODE,jdbcType=VARCHAR}
	AND rownum=1
  </select>


    <select id="updateList" parameterType="java.util.Map"  resultMap="BaseResultMap">
			   select i.*
		  from p_channel_info p, p_product_info i
		 where p.ci_channel_code = i.pi_channel_code
		   and p.ci_channel_code = #{CHANNELCODE,jdbcType=VARCHAR}
		   and p.ci_check_state = '01'
		   and p.ci_valid_flag = '01'
		   and i.pi_check_state = '01'
		   and i.PI_VALID_FLAG != '00'
		   and i.PI_VALID_FLAG != '99'
		   and to_date(i.pi_pro_end_date, 'yyyymmdd') &lt; to_date(#{TRADEDATE,jdbcType=VARCHAR} , 'yyyymmdd')
  </select>


    <select id="selectProductCount" resultType="int" parameterType="String">
  		   select count(*) from p_product_info where PI_CHANNEL_PRODUCT_CODE=#{channelProductCode,jdbcType=VARCHAR}  
    </select>

    <select id="queryTnFundInfoComBox" resultType="Map" >
  		   select PI_CHANNEL_PRODUCT_CODE ID,PI_CHANNEL_PRODUCT_NAME || '(' || PI_CHANNEL_PRODUCT_CODE || ')' NAME from p_product_info
  		     where PI_VALID_FLAG not in('00','99')
  		       AND PI_CHECK_STATE ='01' 
  		       AND PI_PRODUCT_TYPE = '6'
  		      <if test="CHANNELCODE != null and CHANNELCODE != '' ">
               AND PI_CHANNEL_CODE = #{CHANNELCODE, jdbcType = VARCHAR}
              </if>
    </select>

    <select id="queryTaFundInfoComBox" resultType="Map" parameterType="Map">
        <!-- select cp_ta_product_code id,cp_ta_product_name ||'('||cp_ta_product_code|| ')' name from p_channel_product  -->
        select cp_ta_product_code id,
        cp_ta_product_name || '(' || cp_ta_product_code || ')' || '-' ||
        cp_batch_no name
        from p_channel_product, p_product_info
        where pi_channel_code = cp_channel_code
        and pi_channel_product_code = cp_channel_product_code
        and pi_batch_no = cp_batch_no
        and pi_valid_flag not in ('00', '99')
        and pi_check_state = '01'
        and cp_valid_flag = '01'
        and cp_check_state = '01'
        and pi_product_type = '6'
        and cp_channel_code = #{channelCode, jdbcType = VARCHAR}
        and cp_channel_product_code = #{fundCode, jdbcType = VARCHAR}

    </select>

    <select id="selectProductList" parameterType="Map" resultMap="BaseResultMap">
        select PI_ID, PI_PRODUCT_TYPE, PI_CHANNEL_PRODUCT_CODE, PI_CHANNEL_PRODUCT_NAME,
        PI_INDI_MIN_BIDS_AMT, PI_INST_MIN_BIDS_AMT, PI_INDI_BIDS_DIFF_AMT, PI_INST_BIDS_DIFF_AMT,
        PI_INDI_MAX_BIDS_AMT, PI_INST_MAX_BIDS_AMT, PI_INDI_MIN_APP_BIDS_AMT, PI_INST_MIN_APP_BIDS_AMT,
        PI_INDI_APP_BIDS_DIFF_AMT, PI_INST_APP_BIDS_DIFF_AMT, PI_INDI_MAX_APP_BIDS_AMT, PI_INST_MAX_APP_BIDS_AMT,
        PI_INDI_MIN_REDEEM_VOL, PI_INST_MIN_REDEEM_VOL, PI_INDI_REDEEM_DIFF, PI_INST_REDEEM_DIFF,
        PI_INDI_MAX_VOL, PI_INST_MAX_VOL, PI_INDI_MIN_VOL, PI_INST_MIN_VOL, PI_CHANNEL_RATE,
        PI_PAY_TYPE, PI_IPO_BEGIN_DATE, PI_IPO_END_DATE, PI_PRO_SETUP_DATE, PI_PRO_END_DATE,
        PI_PRO_YIELD_TYPE, PI_PRO_YIELD, PI_FEE_FLAG, PI_INDI_BUY_FLAG, PI_INST_BUY_FLAG,
        PI_PRO_CFM_WAY, PI_CHECK_STATE, PI_CTIME, PI_UTIME, PI_CUSER, PI_UUSER, PI_CURRENCY_TYPE,
        PI_ANNU_CAL_DAYS,  PI_PRODUCT_TOTAL_SHARE, PI_VALID_FLAG,PI_Accu_explain_buy_limit,PI_MIN_INDI_AMOUNT_RAISED,PI_MIN_INST_AMOUNT_RAISED,PI_MAX_INST_AMOUNT_RAISED,
        PI_MAX_AMOUNT_RAISED,PI_ACTION,PI_PRO_CALCULATE_TYPE,PI_TEMPLATE_CODE,PI_BATCH_NO,PI_CHANNEL_CODE,PI_SUB_CHANNEL_CODE
        from P_PRODUCT_INFO
        where PI_CHANNEL_PRODUCT_CODE = #{productCode,jdbcType=DECIMAL}
        and PI_BATCH_NO = #{batchNumber,jdbcType=VARCHAR}
        and PI_CHANNEL_CODE = #{channelCode,jdbcType=VARCHAR}
        and PI_VALID_FLAG !='00'
        and PI_VALID_FLAG !='99'
        <if test="checkState != '00' or checkState == null" >
            and PI_CHECK_STATE='01'
        </if>

    </select>



    <select id="queryAllTaFundInfoComBox" resultType="Map">
  		  select c_fundcode ID, c_fundname || '(' || c_fundcode || ')' NAME from ta_tfundInfo
    </select>



    <select id="selectTaProductCount" resultType="int" parameterType="String">
  		   select count(*) from ta_tfundInfo where c_fundcode=#{fundCode,jdbcType=VARCHAR}  
    </select>

    <select id="queryProductInfoComBox" resultType="Map" parameterType="String">
        select  distinct PI_CHANNEL_PRODUCT_CODE ID,PI_CHANNEL_PRODUCT_NAME || '(' || PI_CHANNEL_PRODUCT_CODE || ')' NAME from p_product_info where pi_valid_flag in('10','01') and pi_check_state='01'
        <if test="channelCode != null and channelCode != ''">
            and pi_channel_code = #{channelCode,jdbcType=VARCHAR}
        </if>

    </select>

    <select id="queryAllProductInfoComBox" resultType="Map">
  		   select PI_CHANNEL_PRODUCT_CODE ID,PI_CHANNEL_PRODUCT_NAME || '(' || PI_CHANNEL_PRODUCT_CODE || ')' NAME from p_product_info where (PI_VALID_FLAG !='99' OR PI_CHECK_STATE !='01')
  		   <if test="CHANNELCODE != null and CHANNELCODE != ''">
            and pi_channel_code = #{CHANNELCODE,jdbcType=VARCHAR}
           </if>
    </select>

    <select id="queryUsedProductInfoComBox" resultType="Map">
        select PI_CHANNEL_PRODUCT_CODE || '-'|| PI_BATCH_NO ID,PI_CHANNEL_PRODUCT_NAME || '(' || PI_CHANNEL_PRODUCT_CODE || ')'  || '-'|| PI_BATCH_NO  NAME from p_product_info where PI_VALID_FLAG in('01','10') AND PI_CHECK_STATE='01'
        <if test="channelCode != null and channelCode != '' ">
            and PI_CHANNEL_CODE = #{channelCode,jdbcType = VARCHAR}
        </if>
    </select>

    <update id="updateProSetAndEndDate" parameterType="Map" >

        <foreach collection="tradeInfoList" item="item" index="index" open="begin" close=";end;" separator=";">
            update P_PRODUCT_INFO T set T.PI_PRO_END_DATE =#{transDate,jdbcType=VARCHAR}
            WHERE  T.PI_CHANNEL_CODE = #{item.CHANNELCODE,jdbcType = VARCHAR}
            AND T.PI_BATCH_NO = #{item.BATCHNO,jdbcType = VARCHAR}
            AND T.PI_CHANNEL_PRODUCT_CODE = #{item.FUNDCODE,jdbcType = VARCHAR}
        </foreach>
    </update>
    <update id="updateConnetBatchNo" parameterType="Map">
 	update  p_channel_product set cp_batch_no = #{newBatchNo,jdbcType = VARCHAR} where cp_batch_no = #{batchNo,jdbcType = VARCHAR} and  cp_channel_product_code = #{productCode,jdbcType = VARCHAR}
 </update>

    <!-- 查询特殊类产品的确认方式和产品代码 -->
    <select id="selectProductCfmWay" parameterType="Map" resultType="Map">
	select distinct t.pi_channel_product_code fundcode,
       nvl(t.pi_pro_cfm_way, '1') cfmday
	  from p_product_info t,p_channel_product p
	   where p.cp_channel_code = t.pi_channel_code
	   and t.pi_channel_product_code = p.cp_channel_product_code
	   and t.pi_product_type = #{PRODUCTTYPE,jdbcType = VARCHAR}
	   and t.pi_valid_flag not in ('00', '99')
	   and t.pi_check_state = '01'
	   and p.cp_valid_flag = '01'
	   and p.cp_check_state = '01'
	   and t.pi_channel_code = #{CHANNELCODE,jdbcType = VARCHAR}
 </select>

    <select id="queryRemainShares" parameterType="Map" resultType="Map">
 	select sum(t.f_shares_valid) F_REMAINSHARES,
       sum(t.f_shares_all) f_shares_all
	  from v_shares_status t
	  where t.l_contractserialno = #{inContract,jdbcType = VARCHAR}
	  and t.c_fundcode = #{taProductCode,jdbcType = VARCHAR}
 	
 </select>
    <select id="selectByChannelAndTypes" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>
        from
        p_product_info
        <where>
            <if test="channelCode != null">
                and pi_channel_code = #{channelCode,jdbcType = VARCHAR}
            </if>
            <if test="productTypes != null">
                and Pi_Product_Type in
                <foreach collection="productTypes" open="(" close=")" item="item" index="index" separator=",">
                    #{item,jdbcType = VARCHAR}
                </foreach>
            </if>
            and pi_valid_flag = '00'
            and pi_check_state = '01'
        </where>
    </select>
    <select id="queryTransConfirmDay" parameterType="map" resultType="map">
        select t.po_product_code fundcode, t.po_close_day confirmday
        from p_product_open_day t
        where t.po_channel_code = #{CHANNELCODE,jdbcType = VARCHAR}
        and t.po_open_day_type = #{CONFIRMTYPE,jdbcType = VARCHAR}
        and t.po_check_state = '01'
        <if test="FUNDLIST != null ">
            and t.po_product_code in
            <foreach collection="FUNDLIST" index="index" item="item" separator="," open="(" close=")">
                #{item.FUNDCODE,jdbcType = VARCHAR}
            </foreach>
        </if>
        and exists (
        select 1 from p_product_info p
        where pi_valid_flag not in ('00','99')
        and p.pi_channel_code = t.po_channel_code
        and t.po_product_code = p.pi_channel_product_code
        )
    </select>
    <select id="queryTransOpenDays" parameterType="map" resultType="map">
        select t.po_product_code fundcode, max(t.po_close_day) openday
        from p_product_open_day t
        where t.po_channel_code = #{CHANNELCODE,jdbcType = VARCHAR}
        and t.po_open_day_type = #{CONFIRMTYPE,jdbcType = VARCHAR}
        and t.po_check_state = '01'
        <if test="FUNDLIST != null">
            and t.po_product_code in
            <foreach collection="FUNDLIST" index="index" item="item" separator="," open="(" close=")">
                #{item.FUNDCODE,jdbcType = VARCHAR}
            </foreach>
        </if>
        and t.po_close_day &lt;#{TRANSDATE,jdbcType = VARCHAR}
        group by t.po_product_code
    </select>

    <select id="countProductSubChannelCode" parameterType="map" resultType="int">
    	select count(*)
  from p_product_info t
 where t.pi_channel_code =#{channelCode,jdbcType = VARCHAR}
   and t.pi_currency_type =#{currentType,jdbcType = VARCHAR}
   and t.pi_valid_flag not in('00','99')
   and t.pi_check_state='01'
    </select>
</mapper>