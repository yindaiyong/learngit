<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sams.custom.mapper.AccountStatMapper" >
  <resultMap id="BaseResultMap" type="com.sams.custom.model.AccountStat" >
    <id column="AS_ID" property="asId" jdbcType="DECIMAL" />
    <result column="AS_CHANNEL_CODE" property="asChannelCode" jdbcType="VARCHAR" />
    <result column="AS_INDIVIDUAL_OR_INSTITUTION" property="asIndividualOrInstitution" jdbcType="VARCHAR" />
    <result column="AS_CERTIFICATE_NO" property="asCertificateNo" jdbcType="VARCHAR" />
    <result column="AS_CERTIFICATE_TYPE" property="asCertificateType" jdbcType="VARCHAR" />
    <result column="AS_TA_ACCOUNT_ID" property="asTaAccountId" jdbcType="VARCHAR" />
    <result column="AS_OPEN_ACCOUNT_STAT" property="asOpenAccountStat" jdbcType="VARCHAR" />
    <result column="AS_OPEN_CHANNEL_STAT" property="asOpenChannelStat" jdbcType="VARCHAR" />
    <result column="AS_FIRST_TRADE_FLAG" property="asFirstTradeFlag" jdbcType="VARCHAR" />
    <result column="AS_CTIME" property="asCtime" jdbcType="TIMESTAMP" />
    <result column="AS_UTIME" property="asUtime" jdbcType="TIMESTAMP" />
    <result column="AS_CUSER" property="asCuser" jdbcType="VARCHAR" />
    <result column="AS_UUSER" property="asUuser" jdbcType="VARCHAR" />
    <result column="AS_TRANSACTION_ACCOUNT_ID" property="asTransactionAccountId" jdbcType="VARCHAR" />
    <result column="AS_INVESTOR_NAME" property="asInvestorName" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    AS_ID, AS_CHANNEL_CODE, AS_INDIVIDUAL_OR_INSTITUTION, AS_CERTIFICATE_NO, AS_CERTIFICATE_TYPE, 
    AS_TA_ACCOUNT_ID, AS_OPEN_ACCOUNT_STAT, AS_OPEN_CHANNEL_STAT, AS_FIRST_TRADE_FLAG, 
    AS_CTIME, AS_UTIME, AS_CUSER, AS_UUSER,AS_TRANSACTION_ACCOUNT_ID,AS_INVESTOR_NAME
  </sql>
  
  <insert id="insert" parameterType="com.sams.custom.model.AccountStat" >
    insert into D_ACCOUNT_STAT ( AS_CHANNEL_CODE, AS_INDIVIDUAL_OR_INSTITUTION, 
      AS_CERTIFICATE_NO, AS_CERTIFICATE_TYPE, AS_TA_ACCOUNT_ID, 
      AS_OPEN_ACCOUNT_STAT, AS_OPEN_CHANNEL_STAT, AS_FIRST_TRADE_FLAG, 
      AS_CTIME, AS_UTIME, AS_CUSER, 
      AS_UUSER,AS_INVESTOR_NAME)
    values (#{asChannelCode,jdbcType=VARCHAR}, #{asIndividualOrInstitution,jdbcType=VARCHAR}, 
      #{asCertificateNo,jdbcType=VARCHAR}, #{asCertificateType,jdbcType=VARCHAR}, #{asTaAccountId,jdbcType=VARCHAR}, 
      #{asOpenAccountStat,jdbcType=VARCHAR}, #{asOpenChannelStat,jdbcType=VARCHAR}, #{asFirstTradeFlag,jdbcType=VARCHAR}, 
      #{asCtime,jdbcType=TIMESTAMP}, #{asUtime,jdbcType=TIMESTAMP}, #{asCuser,jdbcType=VARCHAR}, 
      #{asUuser,jdbcType=VARCHAR},#{asInvestorName,jdbcType=VARCHAR},)
  </insert>
  <insert id="insertSelective" parameterType="com.sams.custom.model.AccountStat" >
    insert into D_ACCOUNT_STAT
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="asId != null" >
        AS_ID,
      </if>
      <if test="asChannelCode != null" >
        AS_CHANNEL_CODE,
      </if>
      <if test="asIndividualOrInstitution != null" >
        AS_INDIVIDUAL_OR_INSTITUTION,
      </if>
      <if test="asCertificateNo != null" >
        AS_CERTIFICATE_NO,
      </if>
      <if test="asCertificateType != null" >
        AS_CERTIFICATE_TYPE,
      </if>
      <if test="asTaAccountId != null" >
        AS_TA_ACCOUNT_ID,
      </if>
      <if test="asOpenAccountStat != null" >
        AS_OPEN_ACCOUNT_STAT,
      </if>
      <if test="asOpenChannelStat != null" >
        AS_OPEN_CHANNEL_STAT,
      </if>
      <if test="asFirstTradeFlag != null" >
        AS_FIRST_TRADE_FLAG,
      </if>
      <if test="asTransactionAccountId != null" >
        AS_TRANSACTION_ACCOUNT_ID,
      </if>
      <if test="asUtime != null" >
        AS_UTIME,
      </if>
      <if test="asCuser != null" >
        AS_CUSER,
      </if>
      <if test="asUuser != null" >
        AS_UUSER,
      </if>
      <if test="asInvestorName != null" >
        AS_INVESTOR_NAME,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="asId != null" >
        #{asId,jdbcType=DECIMAL},
      </if>
      <if test="asChannelCode != null" >
        #{asChannelCode,jdbcType=VARCHAR},
      </if>
      <if test="asIndividualOrInstitution != null" >
        #{asIndividualOrInstitution,jdbcType=VARCHAR},
      </if>
      <if test="asCertificateNo != null" >
        #{asCertificateNo,jdbcType=VARCHAR},
      </if>
      <if test="asCertificateType != null" >
        #{asCertificateType,jdbcType=VARCHAR},
      </if>
      <if test="asTaAccountId != null" >
        #{asTaAccountId,jdbcType=VARCHAR},
      </if>
      <if test="asOpenAccountStat != null" >
        #{asOpenAccountStat,jdbcType=VARCHAR},
      </if>
      <if test="asOpenChannelStat != null" >
        #{asOpenChannelStat,jdbcType=VARCHAR},
      </if>
      <if test="asFirstTradeFlag != null" >
        #{asFirstTradeFlag,jdbcType=VARCHAR},
      </if>
      <if test="asTransactionAccountId != null" >
        #{asTransactionAccountId,jdbcType=VARCHAR},
      </if>
      <if test="asUtime != null" >
        #{asUtime,jdbcType=TIMESTAMP},
      </if>
      <if test="asCuser != null" >
        #{asCuser,jdbcType=VARCHAR},
      </if>
      <if test="asUuser != null" >
        #{asUuser,jdbcType=VARCHAR},
      </if>
      <if test="asInvestorName != null" >
        #{asInvestorName,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.sams.custom.model.AccountStat" >
    update D_ACCOUNT_STAT
    <set >
      <if test="asChannelCode != null" >
        AS_CHANNEL_CODE = #{asChannelCode,jdbcType=VARCHAR},
      </if>
      <if test="asIndividualOrInstitution != null" >
        AS_INDIVIDUAL_OR_INSTITUTION = #{asIndividualOrInstitution,jdbcType=VARCHAR},
      </if>
      <if test="asCertificateNo != null" >
        AS_CERTIFICATE_NO = #{asCertificateNo,jdbcType=VARCHAR},
      </if>
      <if test="asCertificateType != null" >
        AS_CERTIFICATE_TYPE = #{asCertificateType,jdbcType=VARCHAR},
      </if>
      <if test="asTaAccountId != null" >
        AS_TA_ACCOUNT_ID = #{asTaAccountId,jdbcType=VARCHAR},
      </if>
      <if test="asOpenAccountStat != null" >
        AS_OPEN_ACCOUNT_STAT = #{asOpenAccountStat,jdbcType=VARCHAR},
      </if>
      <if test="asOpenChannelStat != null" >
        AS_OPEN_CHANNEL_STAT = #{asOpenChannelStat,jdbcType=VARCHAR},
      </if>
      <if test="asFirstTradeFlag != null" >
        AS_FIRST_TRADE_FLAG = #{asFirstTradeFlag,jdbcType=VARCHAR},
      </if>
      <if test="asCtime != null" >
        AS_CTIME = #{asCtime,jdbcType=TIMESTAMP},
      </if>
      <if test="asUtime != null" >
        AS_UTIME = #{asUtime,jdbcType=TIMESTAMP},
      </if>
      <if test="asCuser != null" >
        AS_CUSER = #{asCuser,jdbcType=VARCHAR},
      </if>
      <if test="asUuser != null" >
        AS_UUSER = #{asUuser,jdbcType=VARCHAR},
      </if>
      <if test="asInvestorName != null" >
        AS_INVESTOR_NAME = #{asInvestorName,jdbcType=VARCHAR},
      </if>
    </set>
    where AS_ID = #{asId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.sams.custom.model.AccountStat" >
    update D_ACCOUNT_STAT
    set AS_CHANNEL_CODE = #{asChannelCode,jdbcType=VARCHAR},
      AS_INDIVIDUAL_OR_INSTITUTION = #{asIndividualOrInstitution,jdbcType=VARCHAR},
      AS_CERTIFICATE_NO = #{asCertificateNo,jdbcType=VARCHAR},
      AS_CERTIFICATE_TYPE = #{asCertificateType,jdbcType=VARCHAR},
      AS_TA_ACCOUNT_ID = #{asTaAccountId,jdbcType=VARCHAR},
      AS_OPEN_ACCOUNT_STAT = #{asOpenAccountStat,jdbcType=VARCHAR},
      AS_OPEN_CHANNEL_STAT = #{asOpenChannelStat,jdbcType=VARCHAR},
      AS_FIRST_TRADE_FLAG = #{asFirstTradeFlag,jdbcType=VARCHAR},
      AS_CTIME = #{asCtime,jdbcType=TIMESTAMP},
      AS_UTIME = #{asUtime,jdbcType=TIMESTAMP},
      AS_CUSER = #{asCuser,jdbcType=VARCHAR},
      AS_UUSER = #{asUuser,jdbcType=VARCHAR},
      AS_INVESTOR_NAME = #{asInvestorName,jdbcType=VARCHAR}
    where AS_ID = #{asId,jdbcType=DECIMAL}
  </update>
  
  <select id = "selectAccountStatus" resultMap="BaseResultMap" parameterType="hashMap">
  		select 
  		<include refid="Base_Column_List"/>
  		 from d_account_stat where 1=1
  		<if test="CHANNELCODE != null and CHANNELCODE != '' " >
  			and as_channel_code = #{CHANNELCODE,jdbcType=VARCHAR} 
  		</if>
  		<if test="CERTIFICATETYPE != null and CERTIFICATETYPE != '' " >
  			and as_certificate_type = #{CERTIFICATETYPE,jdbcType=VARCHAR}
  		</if>
  		<if test="INDIVIDUALORINSTITUTION != null and INDIVIDUALORINSTITUTION != '' " >
  			and as_individual_or_institution = #{INDIVIDUALORINSTITUTION,jdbcType=VARCHAR}
  		</if>
  		<if test="CERTIFICATENO != null and CERTIFICATENO != '' " >
  			and as_certificate_no = #{CERTIFICATENO,jdbcType=VARCHAR}
  		</if>
  		<if test="TAACCOUNTID != null and TAACCOUNTID !=''" >
  			and AS_TA_ACCOUNT_ID = #{TAACCOUNTID,jdbcType=VARCHAR}
  		</if>
  		<if test="TRANSACTIONACCOUNTID != null and TRANSACTIONACCOUNTID !=''" >
  			and AS_TRANSACTION_ACCOUNT_ID = #{TRANSACTIONACCOUNTID,jdbcType=VARCHAR}
  		</if>
  </select>
  
  <select id = "qrySendTaAccountStatus" resultMap="BaseResultMap" parameterType="hashMap">
  		select 
  		<include refid="Base_Column_List"/>
  		 from d_account_stat where 1=1
  			and as_channel_code = #{CHANNELCODE,jdbcType=VARCHAR}
  			and AS_TRANSACTION_ACCOUNT_ID = #{TRANSACTIONACCOUNTID,jdbcType=VARCHAR}
  </select>
  
  <select id = "queryTAaccountInfo" resultType="String" parameterType="Map">
  		select c_fundacco from ta_taccoinfo t left join ta_tcustomerinfo t1 on t.c_custno = t1.c_custno  where 1 = 1
  			and c_identitytype = #{CERTIFICATETYPE,jdbcType=VARCHAR}
  			and c_identityno = #{CERTIFICATENO,jdbcType=VARCHAR}
  			and c_custtype = #{INDIVIDUALORINSTITUTION,jdbcType=VARCHAR}
  		and rownum = 1 
  </select>
  
  <select id = "selectTAttrustcustagency" resultType="String" parameterType="Map">
  		select c_trustagencyno from ta_ttrustcustagency where 1=1 
  			and c_trustagencyno = #{CHANNELCODE,jdbcType=VARCHAR}
  			and c_fundacco = #{TAACCOUNTID,jdbcType=VARCHAR}
  		and rownum = 1
  </select>
  
  <update id="updateOpenStat" parameterType="Map">
  		update d_account_stat 
  		<set> 
  		<if test="OPENACCOUNTSTAT != null and OPENACCOUNTSTAT != '' " >
  			AS_OPEN_ACCOUNT_STAT = #{OPENACCOUNTSTAT,jdbcType = VARCHAR},
  		</if>
  		<if test="OPENCHANNELSTAT != null and OPENCHANNELSTAT != '' " >
  			AS_OPEN_CHANNEL_STAT = #{OPENCHANNELSTAT,jdbcType = VARCHAR},
  		</if>
  		<!-- <if test="INVESTORNAME != null and INVESTORNAME != '' " >
  			 AS_INVESTOR_NAME = #{INVESTORNAME,jdbcType=VARCHAR},
  		</if> -->
  		<if test="FIRSTTRADEFLAG != null and FIRSTTRADEFLAG != '' " >
  			AS_FIRST_TRADE_FLAG= #{FIRSTTRADEFLAG,jdbcType = VARCHAR},
  		</if>
  		</set>
  		WHERE as_channel_code = #{CHANNELCODE,jdbcType=VARCHAR} 
		and as_certificate_type = #{CERTIFICATETYPE,jdbcType=VARCHAR}
		and as_individual_or_institution = #{INDIVIDUALORINSTITUTION,jdbcType=VARCHAR}
		and as_certificate_no = #{CERTIFICATENO,jdbcType=VARCHAR}
		and AS_TA_ACCOUNT_ID = #{TAACCOUNTID,jdbcType=VARCHAR}
  </update>
</mapper>